(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";var _,news,newsCtrl,newsDir,newsFcty,newsFilter,newsPanelCtrl,pagination,viewDetection;require("angular"),require("angular-resource"),_=require("lodash"),viewDetection=require("viewport-detection"),pagination=require("angular-pagination"),newsCtrl=require("./newsCtrl.coffee"),newsPanelCtrl=require("./newsPanelCtrl.coffee"),newsFcty=require("./newsFcty.coffee"),newsFilter=require("./newsFilters.coffee"),newsDir=require("./newsDir.coffee"),news=angular.module("$news",["ngResource","$pagination","$viewportDetection"]).factory("NewsFcty",newsFcty).filter("monthFilter",newsFilter).controller("NewsCtrl",newsCtrl).directive("news",newsDir).run(["$templateCache",function(e){return e.put("directives/pagination.html",'<ul class="pagination" ng-show="showPagination"><li class="prev" ng-class="prevPageDisabled()"><a ng-click="prevPage()" rel="previous" title="Previous" href="javascript:"><span>&lsaquo; Prev</span></a></li><li class="page" ng-class="setActive(n)" ng-repeat="n in range()"><a rel="start" ng-click="setPage(n)" href="javascript:">{{n+1}}</a></li><li class="next" ng-class="nextPageDisabled()"><a ng-click="nextPage()" rel="next" title="next" href="javascript:"><span>&rsaquo; Next</span></a></li></ul>')}]),module.exports=news;


},{"./newsCtrl.coffee":2,"./newsDir.coffee":3,"./newsFcty.coffee":4,"./newsFilters.coffee":5,"./newsPanelCtrl.coffee":6,"angular":"angular","angular-pagination":"angular-pagination","angular-resource":"angular-resource","lodash":"lodash","viewport-detection":"viewport-detection"}],2:[function(require,module,exports){
"use strict";var _;_=require("lodash"),module.exports=["$scope","$sce","$filter","NewsFcty","PaginationService","resizer",function(e,t,n,i,r,o){var u,l;return e.newsArticles=[],e.locations=[],e.error=null,e.selectedMonth=null,e.itemCount=0,l=o.windowSize(),e.device=o.getDevice(l.width),o.trackSize(function(t){return e.device=t,e.$apply()}),u=function(t){return null==t&&(t=null),i.getData().then(function(t){return r.setPage(0),_.isEmpty(t.data)?void 0:(e.itemCount=t.data.length,e.months=t.months,e.newsArticles=t.data)},function(t){return e.error=t})},e.filteredNews=function(){var t;return t=n("monthFilter")(e.newsArticles,e.selectedMonth),e.itemCount=t.length,t=n("itemsForCurrentPage")(t),e.pageCount=t.length,t},e.has_img=function(e){return _.isEmpty(e)?"no-image":"with-image"},e.hideAtMobile=function(){return"mobile"!==e.device},u()}];


},{"lodash":"lodash"}],3:[function(require,module,exports){
var _;_=require("lodash"),module.exports=function(){return{restrict:"A",transclude:!0,controller:"NewsCtrl",scope:{},templateUrl:"news/news.html"}};


},{"lodash":"lodash"}],4:[function(require,module,exports){
"use strict";var DateFormatter,_,dateFmt;_=require("lodash"),DateFormatter=require("date-formatter"),dateFmt=new DateFormatter,module.exports=function(t,e){var r,n;return r=[],n="/",{addDate:function(t){return _.isEmpty(t)?t:(_.forEach(t,function(t){return t.pubDate=dateFmt.dateFix(t.published),t.fmtPub=dateFmt.formatDate(t.pubDate,"%d %B %Y")}),t)},data:function(){return r},flush:function(){return r=[]},getMonths:function(t){var e;return e=[],_.forEach(t,function(t){var r,n,a;return n=t.published.replace(/(\d{2})*$/,"01"),a=_.pluck(e,"str"),_.contains(a,n)?void 0:(r=dateFmt.dateFix(n),e.push({date:r,str:n,txt:dateFmt.formatDate(r,"%B, %Y")}))}),e},getData:function(n){var a,u;return null==n&&(n=null),a=e.defer(),_.isEmpty(r)?(u=this,t.get("/api/news.json").success(function(t){return r=u.addDate(t),a.resolve({data:r,months:u.getMonths(r)})}).error(function(){return a.reject("An error occurred while fetching items, we have been notified and are investigating.  Please try again later")})):a.resolve({data:r,months:this.getMonths(r)}),a.promise},getUrl:function(){return n},setUrl:function(t){return n=t},setData:function(t){return r=t}}};


},{"date-formatter":7,"lodash":"lodash"}],5:[function(require,module,exports){
"use strict";var _;_=require("lodash"),module.exports=function(){return function(e,t){var r,u;return _.isNull(t)||_.isUndefined(t)?e:(r=t.date.getMonth(),u=t.date.getFullYear(),_.filter(e,function(e){return e.pubDate.getMonth()===r&&e.pubDate.getFullYear()===u}))}};


},{"lodash":"lodash"}],6:[function(require,module,exports){
"use strict";var _;_=require("lodash"),module.exports=["$scope","$sce","NewsFcty",function(e,s,t){return e.panelNews=[],t.flush(),t.getNews().then(function(s){return e.panelNews=_.first(s.data,2)})}];


},{"lodash":"lodash"}],7:[function(require,module,exports){
"use strict";

var _createClass = (function () { function defineProperties(target, props) { for (var key in props) { var prop = props[key]; prop.configurable = true; if (prop.value) prop.writable = true; } Object.defineProperties(target, props); } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

var _classCallCheck = function (instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } };

var DateFormatter = (function () {
  function DateFormatter() {
    _classCallCheck(this, DateFormatter);

    var args = Array.prototype.slice.call(arguments);
    // yyyy-mm-dd hh:mm:ss
    // yyyy-mm-dd hh:mm
    // yyyy-mm-dd
    this.date_test = /^\d{4}-\d{2}-\d{2}( \d{2}:\d{2}:\d{2}(\.\d{3})?)?$/;

    this.date = null;
    this.AMPM = "am";
    this.SHORT_DAYS = ["Sun", "Mon", "Tues", "Weds", "Thurs", "Fri", "Sat"];
    this.DAYS = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
    this.SHORT_MONTHS = ["Jan", "Feb", "March", "April", "May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec"];
    this.MONTHS = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

    this.setDate.apply(this, args);
  }

  _createClass(DateFormatter, {
    compact: {
      value: function compact(array) {
        // Ripped from lodash
        var index = -1,
            length = array ? array.length : 0,
            resIndex = -1,
            result = [];

        while (++index < length) {
          var value = array[index];
          if (value) {
            result[++resIndex] = value;
          }
        }
        return result;
      }
    },
    dateFix: {
      value: function dateFix(date_str) {
        // yyyy-mm-dd hh:mm
        // yyyy-mm-dd hh:mm
        // yyyy-mm-dd
        var date_regex = /^\s*(\d{4})-(\d{2})-(\d{2})+!?(\s(\d{2}):(\d{2})|\s(\d{2}):(\d{2}):(\d+))?$/;
        var matches = date_str.match(date_regex);

        if (matches) {
          matches = this.compact(matches);
          // console.log('matches', matches);

          var year = parseInt(matches[1]);
          var month = parseInt(matches[2], 10) - 1;
          var date = parseInt(matches[3], 10);

          date = new Date(year, month, date);

          if (matches[5]) {
            date.setHours(matches[5]);
          }

          if (matches[6]) {
            date.setMinutes(matches[6]);
          }

          if (matches[7]) {
            date.setSeconds(matches[7]);
          }

          return date;
        } else {
          throw new Error("Date is malformed");
        };
      }
    },
    fixTime: {
      value: function fixTime(t) {
        if (String(t).length < 2) {
          return "0" + t;
        } else {
          return String(t);
        }
      }
    },
    formatDate: {
      value: function formatDate() {
        var date = undefined,
            fmt = undefined;
        date = this.date;

        if (this.isString(arguments[1])) {
          fmt = arguments[1];
        }

        // http://jsperf.com/date-formatting2
        // Year
        fmt = fmt.replace("%y", date.getYear() - 100);
        // Full Year
        fmt = fmt.replace("%Y", date.getFullYear());
        // Set Numbered Month
        fmt = fmt.replace("%m", date.getMonth() + 1);
        // Set Short Month
        fmt = fmt.replace("%b", this.SHORT_MONTHS[date.getMonth()]);
        // Set Month
        fmt = fmt.replace("%B", this.MONTHS[date.getMonth()]);
        // Set Date
        fmt = fmt.replace("%d", date.getDate());
        // Set Short Day
        fmt = fmt.replace("%a", this.SHORT_DAYS[date.getDay()]);
        // Set Day
        fmt = fmt.replace("%A", this.DAYS[date.getDay()]);
        // Set Hours - 24
        fmt = fmt.replace("%H", this.fixTime(date.getHours()));
        // Set Hours - 12
        fmt = fmt.replace("%-l", this.set12Hour(date.getHours()));
        // Set Mins
        fmt = fmt.replace("%M", this.fixTime(date.getMinutes()));
        // Set Secs
        fmt = fmt.replace("%S", this.fixTime(date.getSeconds()));
        // Set AMPM
        fmt = fmt.replace("%p", this.AMPM);

        return fmt;
      }
    },
    getDate: {
      value: function getDate() {
        return this.date;
      }
    },
    isDate: {
      value: function isDate(d) {
        return Object.prototype.toString.call(d) === "[object Date]";
      }
    },
    isString: {
      value: function isString(str) {
        return Object.prototype.toString.call(str) === "[object String]";
      }
    },
    set12Hour: {
      value: function set12Hour(hour) {
        this.AMPM = hour < 12 ? "am" : "pm";
        if (hour <= 12) {
          return hour;
        } else {
          return hour - 12;
        }
      }
    },
    setDate: {
      value: function setDate() {
        var args = Array.prototype.slice.call(arguments);
        if (this.isString(args[0]) && this.date_test.test(args[0])) {
          this.date = this.dateFix(args[0]);
        } else {
          if (this.isString(args[0])) {
            this.date = new Date(args[0]);
          } else {
            this.date = new Date(Date.UTC.apply(null, args));
          }
        }
      }
    }
  });

  return DateFormatter;
})();

module.exports = DateFormatter;
},{}]},{},[1]);
